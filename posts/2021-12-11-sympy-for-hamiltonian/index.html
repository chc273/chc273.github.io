<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Calculating energy of 1D Schrödinger equation using Sympy | Chi's blog</title>
<meta name=keywords content="quantum-chemistry"><meta name=description content="Calculating energy of 1D Schrödinger equation using Sympy I was reading Szabo&rsquo;s book &ldquo;Modern Quantum Chemistry&rdquo; and saw the exercise questions that seem to be solvable via programming. Hence I decided to give it a try and pick up sympy at the same time. I was a mathematica user back in undergrad, but have not used it ever since. Maybe sympy will just do the same trick.
Here is the question (exercise 1."><meta name=author content="Chi Chen"><link rel=canonical href=https://chc273.github.io/posts/2021-12-11-sympy-for-hamiltonian/><link crossorigin=anonymous href=/assets/css/stylesheet.min.8dd6f57454653644cba6929524e195dff93a26fa61dce2b3b2629e50b8d12816.css integrity="sha256-jdb1dFRlNkTLppKVJOGV3/k6Jvph3OKzsmKeULjRKBY=" rel="preload stylesheet" as=style><link rel=icon href=https://chc273.github.io/favicon.ico><link rel=apple-touch-icon href=https://chc273.github.io/apple-touch-icon.png><script>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-145450203-1","auto"),ga("send","pageview"))</script><meta name=twitter:card content="summary"><meta name=twitter:title content="Calculating energy of 1D Schrödinger equation using Sympy | Chi's blog"><meta name=twitter:description content="Calculating energy of 1D Schrödinger equation using Sympy I was reading Szabo&rsquo;s book &ldquo;Modern Quantum Chemistry&rdquo; and saw the exercise questions that seem to be solvable via programming. Hence I decided to give it a try and pick up sympy at the same time. I was a mathematica user back in undergrad, but have not used it ever since. Maybe sympy will just do the same trick.
Here is the question (exercise 1."><meta property="og:title" content="Calculating energy of 1D Schrödinger equation using Sympy | Chi's blog"><meta property="og:description" content="Calculating energy of 1D Schrödinger equation using Sympy I was reading Szabo&rsquo;s book &ldquo;Modern Quantum Chemistry&rdquo; and saw the exercise questions that seem to be solvable via programming. Hence I decided to give it a try and pick up sympy at the same time. I was a mathematica user back in undergrad, but have not used it ever since. Maybe sympy will just do the same trick.
Here is the question (exercise 1."><meta property="og:type" content="article"><meta property="og:url" content="https://chc273.github.io/posts/2021-12-11-sympy-for-hamiltonian/"><meta property="og:image" content="https://chc273.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-12-11T00:00:00+00:00"><meta property="article:modified_time" content="2021-12-11T00:00:00+00:00"><meta property="og:site_name" content="Chi's blog"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://chc273.github.io/posts/"},{"@type":"ListItem","position":3,"name":"Calculating energy of 1D Schrödinger equation using Sympy","item":"https://chc273.github.io/posts/2021-12-11-sympy-for-hamiltonian/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Calculating energy of 1D Schrödinger equation using Sympy | Chi's blog","name":"Calculating energy of 1D Schrödinger equation using Sympy","description":"Calculating energy of 1D Schrödinger equation using Sympy I was reading Szabo\u0026rsquo;s book \u0026ldquo;Modern Quantum Chemistry\u0026rdquo; and saw the exercise questions that seem to be solvable via programming. Hence I decided to give it a try and pick up sympy at the same time. I was a mathematica user back in undergrad, but have not used it ever since. Maybe sympy will just do the same trick.\nHere is the question (exercise 1.","keywords":["quantum-chemistry"],"wordCount":"517","inLanguage":"en","datePublished":"2021-12-11T00:00:00Z","dateModified":"2021-12-11T00:00:00Z","author":[{"@type":"Person","name":"Chi Chen"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://chc273.github.io/posts/2021-12-11-sympy-for-hamiltonian/"},"publisher":{"@type":"Organization","name":"Chi's blog","logo":{"@type":"ImageObject","url":"https://chc273.github.io/favicon.ico"}}}</script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css integrity=sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js integrity=sha384-VQ8d8WVFw0yHhCk5E8I86oOhv48xLpnDZx5T9GogA/Y84DcCKWXDmSDfn13bzFZY crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous onload=renderMathInElement(document.body)></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary-bg:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list-page{background:var(--theme)}.list-page:not(.dark)::-webkit-scrollbar-track{background:0 0}.list-page:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript></head><body class="type-posts kind-page layout-" id=top><script data-no-instant>function switchTheme(e){switch(e){case"light":document.body.classList.remove("dark");break;case"dark":document.body.classList.add("dark");break;default:window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")}}function isDarkTheme(){return document.body.className.includes("dark")}function getPrefTheme(){return localStorage.getItem("pref-theme")}function setPrefTheme(e){switchTheme(e),localStorage.setItem("pref-theme",e)}const toggleThemeCallbacks={};toggleThemeCallbacks.main=e=>{setPrefTheme(e?"light":"dark")},window.addEventListener("toggle-theme",function(){const e=isDarkTheme();for(const t in toggleThemeCallbacks)toggleThemeCallbacks[t](e)});function toggleThemeListener(){window.dispatchEvent(new CustomEvent("toggle-theme"))}</script><script>(function(){const t="auto",e=getPrefTheme(),n=e||t;switchTheme(n)})()</script><header class=header><nav class=nav><div class=logo><a href=https://chc273.github.io accesskey=h title="Chi's blog (Alt + H)">Chi's blog</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://chc273.github.io/posts/ title=Posts class=active>Posts</a></li><li><a href=https://chc273.github.io/search/ title="Search (Alt + /)" data-no-instant accesskey=/>Search</a></li><li><a href=https://chc273.github.io/tags/ title=Tags>Tags</a></li></ul></nav></header><main class="main post"><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://chc273.github.io>Home</a>&nbsp;»&nbsp;<a href=https://chc273.github.io/posts/>Posts</a></div><h1 class=post-title>Calculating energy of 1D Schrödinger equation using Sympy</h1><div class=post-meta><span class=meta-item><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar" style="user-select:text"><rect x="3" y="4" width="18" height="18" rx="2" ry="2" style="user-select:text"/><line x1="16" y1="2" x2="16" y2="6" style="user-select:text"/><line x1="8" y1="2" x2="8" y2="6" style="user-select:text"/><line x1="3" y1="10" x2="21" y2="10" style="user-select:text"/></svg><span>December 11, 2021</span></span><span class=meta-item>
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon" style="user-select:text"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z" style="user-select:text"/><line x1="7" y1="7" x2="7" y2="7" style="user-select:text"/></svg><span class=post-tags><a href=https://chc273.github.io/tags/quantum-chemistry/>quantum-chemistry</a></span></span><span class=meta-item>
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text" style="user-select:text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z" style="user-select:text"/><polyline points="14 2 14 8 20 8" style="user-select:text"/><line x1="16" y1="13" x2="8" y2="13" style="user-select:text"/><line x1="16" y1="17" x2="8" y2="17" style="user-select:text"/><polyline points="10 9 9 9 8 9" style="user-select:text"/></svg><span>517 words</span></span><span class=meta-item>
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke="currentcolor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><span>3 min</span></span></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#calculating-energy-of-1d-schrödinger-equation-using-sympy>Calculating energy of 1D Schrödinger equation using Sympy</a><ul><li><a href=#1-normalization-conditions>1. Normalization conditions</a></li><li><a href=#2-calculate-the-hamiltonian-with-the-trial-function>2. Calculate the Hamiltonian with the trial function</a></li><li><a href=#3-substitute-the-normalization-condition>3. Substitute the normalization condition</a></li><li><a href=#4-minimize-with-respect-to-a>4. Minimize with respect to $$a$$</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h2 id=calculating-energy-of-1d-schrödinger-equation-using-sympy>Calculating energy of 1D Schrödinger equation using Sympy<a hidden class=anchor aria-hidden=true href=#calculating-energy-of-1d-schrödinger-equation-using-sympy>¶</a></h2><p>I was reading Szabo&rsquo;s book &ldquo;Modern Quantum Chemistry&rdquo; and saw the exercise questions that seem to be solvable via programming. Hence I decided to give it a try and pick up <code>sympy</code> at the same time. I was a <code>mathematica</code> user back in undergrad, but have not used it ever since. Maybe <code>sympy</code> will just do the same trick.</p><p>Here is the question (exercise 1.18 from the book)</p><p><strong>The Schrödinger equation (in atomic units) of an electron moving in one dimension under the influence of the potential $$-\delta(x)$$ is</strong></p><p>$$
\left(-\frac{1}{2}\frac{d^2}{dx^2} - \delta(x)\right) | \Phi\rangle = \epsilon | \Phi\rangle
$$</p><p><strong>Use the variation method with the trial function</strong></p><p>$$
| \tilde \Phi \rangle = N e^{-ax^2}
$$</p><p><strong>to show that $$-\pi^{-1}$$ is an upper bound to the exact group state energy (which is -0.5)</strong>.</p><p>From the variational principle, we know if the normalized wavefunction satisfies the appropriate boundary condition, then the expectation of the Hamiltonian is an upper bound to the exact ground state energy. In math expressions, if</p><p>$$
\langle\tilde\Phi|\tilde\Phi \rangle = 1
$$</p><p>then</p><p>$$
\langle\tilde\Phi| \mathcal{H} | \tilde\Phi \rangle \ge \epsilon_0
$$</p><p>I will show how we can use <code>sympy</code> to solve this problem</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sympy</span> <span class=kn>import</span> <span class=o>*</span>  <span class=c1># I dislike this way to import everything, but it seems to be common in sympy</span>
</span></span><span class=line><span class=cl><span class=n>init_printing</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=n>symbols</span><span class=p>(</span><span class=s2>&#34;x&#34;</span><span class=p>)</span>  <span class=c1># define the symbols</span>
</span></span><span class=line><span class=cl><span class=n>N</span><span class=p>,</span> <span class=n>a</span> <span class=o>=</span> <span class=n>symbols</span><span class=p>(</span><span class=s2>&#34;N a&#34;</span><span class=p>,</span> <span class=n>positive</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>  <span class=c1># a should be positive to satisfy boundary cond at infinity</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>phi</span> <span class=o>=</span> <span class=n>N</span> <span class=o>*</span> <span class=n>exp</span><span class=p>(</span><span class=o>-</span><span class=n>a</span> <span class=o>*</span> <span class=n>x</span> <span class=o>**</span> <span class=mi>2</span><span class=p>)</span>  <span class=c1># this is our trial function</span>
</span></span></code></pre></div><h3 id=1-normalization-conditions>1. Normalization conditions<a hidden class=anchor aria-hidden=true href=#1-normalization-conditions>¶</a></h3><p>We will need to normalize the wavefunction</p><p>$$
\langle\tilde\Phi|\tilde\Phi \rangle = 1
$$</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>phi2_int</span> <span class=o>=</span> <span class=n>integrate</span><span class=p>(</span><span class=n>phi</span> <span class=o>*</span> <span class=n>phi</span><span class=p>,</span> <span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=o>-</span><span class=n>oo</span><span class=p>,</span> <span class=n>oo</span><span class=p>))</span>  <span class=c1># the integration of phi * phi. Our function is real here</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>phi2_int</span> 
</span></span></code></pre></div><p>$$\frac{\sqrt{2} \sqrt{\pi} N^{2}}{2 \sqrt{a}}$$</p><p>This expression equals to 1 from our normalization condition. Hence we can solve for $$N$$</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>n_cond</span> <span class=o>=</span> <span class=n>solve</span><span class=p>(</span><span class=n>phi2_int</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>n_cond</span> 
</span></span></code></pre></div><p>$$\left [ \left { N : \frac{\sqrt[4]{2} \sqrt[4]{a}}{\sqrt[4]{\pi}}\right }\right ]$$</p><h3 id=2-calculate-the-hamiltonian-with-the-trial-function>2. Calculate the Hamiltonian with the trial function<a hidden class=anchor aria-hidden=true href=#2-calculate-the-hamiltonian-with-the-trial-function>¶</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>term1</span> <span class=o>=</span> <span class=n>integrate</span><span class=p>(</span><span class=n>phi</span> <span class=o>*</span> <span class=p>(</span><span class=o>-</span><span class=mf>0.5</span> <span class=o>*</span> <span class=n>diff</span><span class=p>(</span><span class=n>diff</span><span class=p>(</span><span class=n>phi</span><span class=p>,</span> <span class=n>x</span><span class=p>),</span> <span class=n>x</span><span class=p>)),</span> <span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=o>-</span><span class=n>oo</span><span class=p>,</span> <span class=n>oo</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>term2</span> <span class=o>=</span> <span class=n>integrate</span><span class=p>(</span><span class=o>-</span><span class=n>phi</span> <span class=o>*</span> <span class=n>DiracDelta</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=o>*</span> <span class=n>phi</span><span class=p>,</span> <span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=o>-</span><span class=n>oo</span><span class=p>,</span> <span class=n>oo</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>H</span> <span class=o>=</span> <span class=n>term1</span> <span class=o>+</span> <span class=n>term2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>H</span>
</span></span></code></pre></div><p>$$0.25 \sqrt{2} \sqrt{\pi} N^{2} \sqrt{a} - N^{2}$$</p><h3 id=3-substitute-the-normalization-condition>3. Substitute the normalization condition<a hidden class=anchor aria-hidden=true href=#3-substitute-the-normalization-condition>¶</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>H_sol</span> <span class=o>=</span> <span class=n>H</span><span class=o>.</span><span class=n>subs</span><span class=p>(</span><span class=n>n_cond</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>H_sol</span> 
</span></span></code></pre></div><p>$$- \frac{\sqrt{2} \sqrt{a}}{\sqrt{\pi}} + 0.5 a$$</p><p>This expression still contains $$a$$. To find the minimum of this equation, we will need to solve for $$a$$</p><h3 id=4-minimize-with-respect-to-a>4. Minimize with respect to $$a$$<a hidden class=anchor aria-hidden=true href=#4-minimize-with-respect-to-a>¶</a></h3><p>$$a$$ is minimal when $$\partial H_{sol}/\partial a = 0$$</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>a_sol</span> <span class=o>=</span> <span class=n>solve</span><span class=p>(</span><span class=n>diff</span><span class=p>(</span><span class=n>H_sol</span><span class=p>,</span> <span class=n>a</span><span class=p>))[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>a_sol</span>
</span></span></code></pre></div><p>$$0.636619772367581$$</p><p>substitute $$a$$ solution into the solution for $$H$$, we get</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>H_sol</span><span class=o>.</span><span class=n>subs</span><span class=p>({</span><span class=n>a</span><span class=p>:</span> <span class=n>a_sol</span><span class=p>})</span><span class=o>.</span><span class=n>evalf</span><span class=p>()</span>
</span></span></code></pre></div><p>$$-0.318309886183791$$</p><p>which is exactly $$-\pi^{-1}$$</p><p>In summary, in this notebook, I show how we can use <code>sympy</code> to solve simple Schrödinger equation. Sometimes, using <code>sympy</code> can be unintuitive especially if the bounds of the variables are not properly set. In that case, you will get piecewise function results, and you will need to manually select the correct solutions.</p><p>I found the use of expression <code>oo</code> to represent infinity quite interesting and brilliant.</p></div><footer class=post-footer><nav class=paginav><a class=prev href=https://chc273.github.io/posts/2022-01-01-fitting-parameters-in-sto-lg/><span class=title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left" style="user-select:text"><line x1="19" y1="12" x2="5" y2="12" style="user-select:text"/><polyline points="12 19 5 12 12 5" style="user-select:text"/></svg>&nbsp;Prev Page</span><br><span>Fitting the parameters in STO-LG</span>
</a><a class=next href=https://chc273.github.io/posts/2019-10-04-speed-comparison-among-numpy-cython-numba-and-tensorflow/><span class=title>Next Page&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right" style="user-select:text"><line x1="5" y1="12" x2="19" y2="12" style="user-select:text"/><polyline points="12 5 19 12 12 19" style="user-select:text"/></svg></span><br><span>Speed comparison among numpy, cython, numba and tensorflow 2.0</span></a></nav></footer><div class=comments-separator></div><div class=comments-box><div id=disqus_thread></div></div><script type=text/javascript>var disqus_config=function(){this.page.url="https://chc273.github.io/posts/2021-12-11-sympy-for-hamiltonian/",this.page.identifier="2021-12-11-sympy-for-hamiltonian"};(function(){const t=window.DISQUS;if(t)t.reset({reload:!0,config:disqus_config});else{var n=document,e=n.createElement("script");e.src="//chc273-github-io.disqus.com/embed.js",e.defer=!0,e.setAttribute("data-timestamp",+new Date),e.setAttribute("data-no-instant",""),n.head.appendChild(e)}})()</script></article></main><footer class=footer><span>&copy; 2024 <a href=https://chc273.github.io>Chi's blog</a></span><span style=display:inline-block;margin-left:1em>
<a href=https://creativecommons.org/licenses/by-sa/4.0/>CC BY-SA</a>
</span><span style=display:inline-block;margin-left:1em>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
    <a href=https://github.com/reorx/hugo-PaperModX/ rel=noopener target=_blank>PaperModX</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>(function(){const t=""=="1";if(t)return;let e=document.getElementById("theme-toggle");e.removeEventListener("click",toggleThemeListener),e.addEventListener("click",toggleThemeListener)})()</script><script>(function(){let e=document.getElementById("menu");e&&(e.scrollLeft=localStorage.getItem("menu-scroll-position"),e.onscroll=function(){localStorage.setItem("menu-scroll-position",e.scrollLeft)});const t=""=="1",n=""=="1";if(window.matchMedia("(prefers-reduced-motion: reduce)").matches||t||n)return;document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})})()</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>if(window.scrollListeners)for(const e of scrollListeners)window.removeEventListener("scroll",e);window.scrollListeners=[]</script><script src=/js/medium-zoom.min.js data-no-instant></script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script>(function(){const a=""=="1";if(!a)return;if(!document.querySelector(".toc")){console.log("no toc found, ignore toc scroll");return}const r=window.scrollListeners,t=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id]"),n="active";let e=t[0];o(e).classList.add(n);const c=()=>{const s=[];for(const e of t)if(l(e)<5)s.push(e);else break;s.length>0?newActiveHeading=s[s.length-1]:newActiveHeading=t[0],e!=newActiveHeading&&(o(e).classList.remove(n),e=newActiveHeading,o(e).classList.add(n))};let s=null;const i=()=>{s!==null&&clearTimeout(s),s=setTimeout(c,50)};window.addEventListener("scroll",i,!1),r.push(i);function o(e){const t=encodeURI(e.getAttribute("id")).toLowerCase();return document.querySelector(`.toc ul li a[href="#${t}"]`)}function l(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect();return t.top}})()</script></body></html>